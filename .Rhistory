Sur1 <- Surv(Cdata$Time, Cdata$Death_Censoring)
Cox.fit <- coxph(Sur1~ factor(Treatment)+ factor(Sex)+ factor(Ascites)+ Age+ Prothrombin, data = Cdata)
Cox.fit
survfit(Cox.fit, Cdata$Treatment=0,Cdata$Sex=1 ,Cdata$Ascites=1,Cdata$Prothrombin=85)
survfit(Cox.fit, Cdata$Treatment==0,Cdata$Sex==1 ,Cdata$Ascites==1,Cdata$Prothrombin==85)
survfit(Cox.fit,newdata = c( Cdata$Treatment==0,Cdata$Sex==1 ,Cdata$Ascites==1,Cdata$Prothrombin==85))
survfit(Cox.fit,newdata = c( Cdata$Treatment=0,Cdata$Sex=1 ,Cdata$Ascites=1,Cdata$Prothrombin=85))
which(Cdata$Treatment==0,Cdata$Sex==1 ,Cdata$Ascites==1,Cdata$Prothrombin==85)
which(Cdata$Treatment==0 & Cdata$Sex==1 & Cdata$Ascites==1 & Cdata$Prothrombin==85)
which(Cdata$Treatment==0 & Cdata$Sex==1 & Cdata$Ascites==1 & Cdata$Age==57 & Cdata$Prothrombin==85)
which(Cdata$Treatment==0 & Cdata$Sex==1 )
which(Cdata$Treatment==0 & Cdata$Sex==1 & Cdata$Ascites==1 )
which(Cdata$Treatment==0 & Cdata$Sex==1 & Cdata$Ascites==1 & Cdata$Age==57 )
which(Cdata$Age==57 & Cdata$Prothrombin==85)
NewCdata=
Cdata[,412]
NewCdata=
Cdata[412,]
NewCdata=
Cdata[412,]
NewCdata=
Cdata$Patient_number=412
cdata
Cdata
Cdata<-read.table("C_data.txt",header = FALSE)
head(Cdata)
colnames(Cdata) <-c("Patient_number", "Death_Censoring", "Time", "Treatment", "Sex", "Ascites", "Age", "Prothrombin")
head(Cdata)
NewCdata=
which(Cdata$Patient_number==412)
NewCdata=
which(Cdata$Patient_number==412)
which(Cdata$Patient_number==412)
Cdata[128]
Cdata[128,]
which(Cdata$Age==57 & Cdata$Prothrombin==85)
which(Cdata$Patient_number==412)
Cdata[128,]
which(Cdata$Age==57 & Cdata$Prothrombin==85)
Cdata[412,]
which(Cdata$Treatment==0 & Cdata$Sex==1 & Cdata$Age==57 & Cdata$Prothrombin==85)
which(Cdata$Treatment==0 & Cdata$Sex==1 & Cdata$Age==57 & Cdata$Prothrombin==85)
Cdata[412,]
NewCdata=Cdata[412,]
survfit(Cox.fit,newdata = NewCdata)
new.surf<-survfit(Cox.fit,newdata = NewCdata)
plot(new.surf)
Sur1 <- Surv(Cdata$Age, Cdata$Death_Censoring)
Cox.fit <- coxph(Sur1~ factor(Treatment)+ factor(Sex)+ factor(Ascites)+ Age+ Prothrombin, data = Cdata)
Cox.fit <- coxph(Sur1~ factor(Treatment)+ factor(Sex)+ factor(Ascites)+ Time+ Prothrombin, data = Cdata)
new.surf<-survfit(Cox.fit,newdata = NewCdata)
plot(new.surf)
Sur1 <- Surv(Cdata$Time, Cdata$Death_Censoring)
Cox.fit <- coxph(Sur1~ factor(Treatment)+ factor(Sex)+ factor(Ascites)+ Age+ Prothrombin, data = Cdata)
Sur2 <- Surv(Cdata$Age, Cdata$Death_Censoring)
Cox.fit_Man <- coxph(Sur1~ factor(Treatment)+ factor(Sex)+ factor(Ascites)+ Time+ Prothrombin, data = Cdata)
Cox.fit_Man
summary(Cox.fit_Man)
which(Cdata$Treatment==0 & Cdata$Sex==1 & Cdata$Age==57 & Cdata$Prothrombin==85)
Cdata[412,]
NewCdata=Cdata[412,]
new.surf<-survfit(Cox.fit_Man,newdata = NewCdata)
plot(new.surf)
Sur2 <- Surv(Cdata$Time, Cdata$Death_Censoring)
Cox.fit_Man <- coxph(Sur1~ factor(Treatment)+ factor(Sex)+ factor(Ascites)+ Age+ Prothrombin, data = Cdata)
Sur2 <- Surv(Cdata$Time, Cdata$Death_Censoring)
Cox.fit_Man <- coxph(Sur2~ factor(Treatment)+ factor(Sex)+ factor(Ascites)+ Age+ Prothrombin, data = Cdata)
Cox.fit_Man
summary(Cox.fit_Man)
which(Cdata$Treatment==0 & Cdata$Sex==1 & Cdata$Age==57 & Cdata$Prothrombin==85)
summary(Cox.fit_Man)
which(Cdata$Treatment==0 & Cdata$Sex==1 & Cdata$Age==57 & Cdata$Prothrombin==85)
Cdata[412,]
NewCdata=Cdata[412,]
new.surf<-survfit(Cox.fit_Man,newdata = NewCdata)
plot(new.surf)
Sur2 <- Surv(Cdata$Age, Cdata$Death_Censoring)
Cox.fit_Man <- coxph(Sur2~ factor(Treatment)+ factor(Sex)+ factor(Ascites)+ Time+ Prothrombin, data = Cdata)
Cox.fit_Man
summary(Cox.fit_Man)
which(Cdata$Treatment==0 & Cdata$Sex==1 & Cdata$Age==57 & Cdata$Prothrombin==85)
Cdata[412,]
NewCdata=Cdata[412,]
new.surf<-survfit(Cox.fit_Man,newdata = NewCdata)
plot(new.surf)
Sur1 <- Surv(Cdata$Time, Cdata$Death_Censoring)
Cox.fit <- coxph(Sur1~ factor(Treatment)+ factor(Sex)+ factor(Ascites)+ Age+ Prothrombin, data = Cdata)
Cox.fit
summary(Cox.fit)
which(Cdata$Treatment==0 & Cdata$Sex==1 & Cdata$Age==57 & Cdata$Prothrombin==85)
Cdata[412,]
NewCdata=Cdata[412,]
new.surf<-survfit(Cox.fit,newdata = NewCdata)
plot(new.surf)
65-57
8*365
Cdata[412,]
2920+2820
plot(new.surf)
2920+2820
new.surf<-survfit(Cox.fit,newdata = NewCdata)
plot(new.surf)
8*365
plot(new.surf)
new.surf[,2920]
new.surf[2920,]
new.surf
which(new.surf$time(2920))
xwhich(new.surf$time(2920))
x[which(new.surf$time(2920))]
Cdata$Death_Censoring[which(new.surf$time(2920))]
Cdata$Death_Censoring[which(new.surf$time==2920)]
plot(new.surf)
Xlim(2920)
plot(new.surf)
Xlim(2920)
Xlim=2920
Xlim=2920
new.surf[2920,]
plot(new.surf)
Xlim=2920
Cdata$Death_Censoring[which(new.surf$time==2920)]
which(new.surf$time==2920)
which(new.surf$time==2920)
new.surf[2920,]
new.surf[2920]
new.surf$time[,2920]
new.surf$time[2920,]
new.surf$Time[2920,]
new.surf$Time[,2920]
Cdata$Death_Censoring[which(new.surf$Time==2920)]
which(new.surfi$me==2920)
which(new.surf$Time==2920)
new.surf$Death_Censoring[which(new.surf$Time==2920)]
which(new.surf$Time==2920)
new.surf<-survfit(Cox.fit,newdata = data.frame(Treatment=0,Sex=1,Age=57,Ascites=1,Prothrombin=85))
plot(new.surf)
Sur1 <- Surv(Cdata$Time, Cdata$Death_Censoring)
Cox.fit <- coxph(Sur1~ factor(Treatment)+ factor(Sex)+ factor(Ascites)+ Age+ Prothrombin, data = Cdata)
Cox.fit
summary(Cox.fit)
65-57
8*365
new.surf<-survfit(Cox.fit,newdata = data.frame(Treatment=0,Sex=1,Age=57,Ascites=1,Prothrombin=85))
plot(new.surf)
new.surf[2920,]
new.surf$Time[2920,]
new.surf$Time
new.surf$time
plot(new.surf,xlim = 2920)
plot(new.surf,ylim = 2920)
plot(new.surf,ylim = 0, xlim = 2920)
plot(new.surf,abline(new.surf$time=2920))
plot(new.surf)
abline(new.surf$time=2920)
abline(new.surf$Time=2920)
abline(new.surf$time=2920)
plot(new.surf)
abline(new.surf$time=2920)
abline(v=2920)
plot(new.surf)
abline(v=2920)
plot(new.surf)
abline(2920)
plot(new.surf)
events <- xts("", new.surf$time=2920
events <- xts("", new.surf$time(2920)
plot(new.surf)
events <- xts("", new.surf$time(2920)
events <- xts("", new.surf$time("2920")
ev <- xts(" ", new.surf$time("2920")
addEventLines(ev, col="red", lwd=2)
plot(new.surf)
ev <- xts(" ", new.surf$time("2920")
plot(new.surf)
plot(new.surf)
new.surf$time
new.surf$time[2917,]
new.surf$time[,2917]
,
new.surf$time[2917]
new.surf[,22917]
new.surf[,2917]
new.surf[2917,]
new.surf<-survfit(Cox.fit,newdata = data.frame(Treatment=0,Sex=1,Age=57,Ascites=1,Prothrombin=85))
plot(new.surf)
autoplot(new.surf,xlab="Days",ylab="Overall survival probability")
plot(new.surf,xlab="Days",ylab="Overall survival probability")
autoplot(new.surf,xlab="Days",ylab="Overall survival probability")
abline(v=2920)
autoplot(new.surf,xlab="Days",ylab="Overall survival probability")
abline(v=2920)
autoplot(new.surf,xlab="Days",ylab="Overall survival probability")abline(v=2920)
autoplot(new.surf,xlab="Days",ylab="Overall survival probability"),abline(v=2920)
autoplot(new.surf,xlab="Days",ylab="Overall survival probability",abline(v=2920))
abline(v=2920)
abline(lm(new.surf)v=2920)
autoplot(new.surf,xlab="Days",ylab="Overall survival probability")
abline(lm(new.surf)v=2920)
library(survival)# the package for durvival functions.
library(ggfortify) # Usefull for intepreting Survival functions plots.
library(KMsurv)
Cdata<-read.table("C_data.txt",header = FALSE)
head(Cdata)
colnames(Cdata) <-c("Patient_number", "Death_Censoring", "Time", "Treatment", "Sex", "Ascites", "Age", "Prothrombin")
head(Cdata)
Surv(Cdata$Time, Cdata$Death_Censoring)[1:10]
Sur1 <- Surv(Cdata$Time, Cdata$Death_Censoring)
Cox.fit <- coxph(Sur1~ factor(Treatment)+ factor(Sex)+ factor(Ascites)+ Age+ Prothrombin, data = Cdata)
Cox.fit
summary(Cox.fit)
new.surf<-survfit(Cox.fit,newdata = data.frame(Treatment=0,Sex=1,Age=57,Ascites=1,Prothrombin=85))
autoplot(new.surf,xlab="Days",ylab="Overall survival probability")
abline(v=2920)
plot(new.surf,xlab="Days",ylab="Overall survival probability")
autoplot(new.surf,xlab="Days",ylab="Overall survival probability")
abline(v=2920)
abline(v=2920)
plot(new.surf,xlab="Days",ylab="Overall survival probability")
abline(v=2920)
abline(v=2920)
plot(new.surf,xlab="Days",ylab="Overall survival probability")
abline(v=2920)
plot(new.surf,xlab="Days",ylab="Overall survival probability")
plot(new.surf,xlab="Days",ylab="Overall survival probability")
abline(v=2920)
autoplot(new.surf,xlab="Days",ylab="Overall survival probability")
time(new.surf)
autoplot(new.surf,xlab="Days",ylab="Overall survival probability")+
geom_vline(xintercept = 2920)
autoplot(new.surf,xlab="Days",ylab="Overall survival probability")+
geom_segment(xintercept = 2920)
autoplot(new.surf,xlab="Days",ylab="Overall survival probability")+
geom_segment(aes(xend=2920,yend=0))
autoplot(new.surf,xlab="Days",ylab="Overall survival probability")+
geom_segment(aes(xend=2920,yend=1))
autoplot(new.surf,xlab="Days",ylab="Overall survival probability")+
geom_segment(aes(xend=2920,yend=0))
autoplot(new.surf,xlab="Days",ylab="Overall survival probability")+
geom_segment(aes(xend=2920,yend=0,25))
autoplot(new.surf,xlab="Days",ylab="Overall survival probability")+
geom_segment(aes(xend=2920,yend=0))
autoplot(new.surf,xlab="Days",ylab="Overall survival probability")+
geom_segment(aes(xend=2920,yend=0))+
geom_segment(aes(xend=0,yend=2920))
autoplot(new.surf,xlab="Days",ylab="Overall survival probability")+
geom_segment(aes(xend=2920,yend=0))+
geom_segment(aes(xend=0,yend=2920))+
geom_line()
autoplot(new.surf,xlab="Days",ylab="Overall survival probability")+
geom_segment(aes(xend=2920,yend=0.24))+
geom_segment(aes(xend=0,yend=2920))+
geom_line()
autoplot(new.surf,xlab="Days",ylab="Overall survival probability")+
geom_segment(aes(xend=2920,yend=0.24))+
geom_line()
autoplot(new.surf,xlab="Days",ylab="Overall survival probability")+
geom_segment(aes(xend=2920,yend=0))+
geom_line()
plot(new.surf,xlab="Days",ylab="Overall survival probability")+
geom_segment(aes(xend=2920,yend=0))+
geom_line()
auto
autoplot(new.surf,xlab="Days",ylab="Overall survival probability")+
geom_segment(aes(xend=2920,yend=0))+
geom_line()
autoplot(new.surf,xlab="Days",ylab="Overall survival probability")+
geom_segment(aes(xend=2920,yend=0))
autoplot(new.surf,xlab="Days",ylab="Overall survival probability")+
geom_vline(xintercept = 2920)
ggplot(new.surf, aes(x=new.surf$time, y=new.surf$n.censor))+
geom_segment(aes(xend=2920, yend=0), color="blue") +
geom_segment(aes(xend=0, yend=2920), color="blue") +
geom_line()
new.surf$n.censor
new.surf$n
new.surf$surv
ggplot(new.surf, aes(x=new.surf$time, y=new.surf$surv))+
geom_segment(aes(xend=2920, yend=0), color="blue") +
geom_segment(aes(xend=0, yend=2920), color="blue") +
geom_line()
autoplot(new.surf,xlab="Days",ylab="Overall survival probability")+
geom_vline(xintercept = 2920)
(65-57)*365
new.age=(65-57)*365
new.surf<-survfit(Cox.fit,newdata = data.frame(Treatment=0,Sex=1,Age=57,Ascites=1,Prothrombin=85))
autoplot(new.surf,xlab="Days",ylab="Overall survival probability")+
geom_vline(xintercept = new.age)
<<<<<<< HEAD
install.packages(c("ggfortify", "KMsurv"))
=======
knitr::opts_chunk$set(echo = TRUE)
library(survival)# the package for durvival functions.
library(survival)# the package for durvival functions.
library(ggfortify) # Usefull for intepreting Survival functions plots.
#library(KMsurv)
Cdata<-read.table("C_data.txt",header = FALSE)
head(Cdata)
colnames(Cdata) <-c("Patient_number", "Death_Censoring", "Time", "Treatment", "Sex", "Ascites", "Age", "Prothrombin")
head(Cdata)
Surv(Cdata$Time, Cdata$Death_Censoring)[1:10]
sur.fit1 <- survfit(Surv(Time, Death_Censoring) ~ Treatment, data=Cdata)
names(sur.fit1)
plot(sur.fit1,xlab="Days",ylab="Overall survival probability")
autoplot(sur.fit1,xlab="Days",ylab="Overall survival probability")
autoplot(sur.fit1,xlab="Days",ylab="Overall survival probability")
Sur1 <- Surv(Cdata$Time, Cdata$Death_Censoring)
#Looking at Treatment
Cox.fit1 <- coxph(Sur1~ strata(Treatment)+ factor(Sex)+ factor(Ascites)+ Age+ Prothrombin, data = Cdata)
summary(Cox.fit1)
source("andersen.R")
test1<-survfit(Cox.fit1)
test1
andersen.plot(test1) # must have strata, plots the cumilated hazard function for the levels of the strata variable
res1<-residuals(Cox.fit1,type="deviance")
hist(res1)
boxplot(res1~Cdata$Death_Censoring)
andersen.plot(test1) # must have strata, plots the cumilated hazard function for the levels of the strata variable
Surv(Cdata$Time, Cdata$Death_Censoring)[1:10]
andersen.plot(test1) # must have strata, plots the cumilated hazard function for the levels of the strata variable
Surv(Cdata$Time, Cdata$Death_Censoring)[1:10]
plot(sur.fit1,xlab="Days",ylab="Overall survival probability") #a normal plot
autoplot(sur.fit1,xlab="Days",ylab="Overall survival probability")
# Log-rank test
Log_rank_test<-survdiff(Surv(Time, Death_Censoring) ~Treatment , data = Cdata)
Log_rank_test # results
1 - pchisq(Log_rank_test$chisq, length(Log_rank_test$n) - 1)#p-value
Log_rank_test # results
1 - pchisq(Log_rank_test$chisq, length(Log_rank_test$n) - 1)#p-value
Sur1 <- Surv(Cdata$Time, Cdata$Death_Censoring)
#Looking at Treatment
Cox.fit1 <- coxph(Sur1~ strata(Treatment)+ factor(Sex)+ factor(Ascites)+ Age+ Prothrombin, data = Cdata)
summary(Cox.fit1)
source("andersen.R")
test1<-survfit(Cox.fit1)
test1
andersen.plot(test1) # must have strata, plots the cumilated hazard function for the levels of the strata variable
# The cumulative hazard looks good.
hist(res1)
# looks good
boxplot(res1~Cdata$Death_Censoring)
#Looking at sex
Cox.fit2 <- coxph(Sur1~ factor(Treatment)+ strata(Sex)+ factor(Ascites)+ Age+ Prothrombin, data = Cdata)
summary(Cox.fit2)
source("andersen.R")
test2<-survfit(Cox.fit2)
test2
andersen.plot(test2) # must have strata, plots the cumilated hazard function for the levels of the strata variable
#Looks good
res2<-residuals(Cox.fit2,type="deviance")
hist(res2)
hist(res1)
# next to no difference
boxplot(res2~Cdata$Death_Censoring)
# Looking at Ascites
Cox.fit3 <- coxph(Sur1~ factor(Treatment)+ factor(Sex)+ strata(Ascites)+ Age+ Prothrombin, data = Cdata)
# Looking at Ascites
Cox.fit3 <- coxph(Sur1~ factor(Treatment)+ factor(Sex)+ strata(Ascites)+ Age+ Prothrombin, data = Cdata)
# Fitting a Cox model
summary(Cox.fit3)
source("andersen.R")
test3<-survfit(Cox.fit3)
test3
test3 #note we now have 3 variables for hazard function
andersen.plot(test3) # must have strata, plots the cumilated hazard function for the levels of the strata variable
hist(res3)
# Looks good for all 3
res3<-residuals(Cox.fit3,type="deviance")
hist(res3)
# We have one noticable high residual variable.
boxplot(res3~Cdata$Death_Censoring)
# Looking at Age
min(Cdata[,7])# youngest person is 17
max(Cdata[,7])# oldest person is 80
Age.groups=cut(Cdata$Age,breaks=c(-Inf,quantile(Cdata$Age ,prob=c(0.33,0.66)),Inf)) #devides the Age into 3 groups
Cox.fit4 <- coxph(Sur1~ factor(Treatment)+ factor(Sex)+ factor(Ascites)+ strata(Age.groups)+ Prothrombin, data = Cdata)
# Fitting a Cox model
summary(Cox.fit4)
source("andersen.R")
test4<-survfit(Cox.fit4)
test4
andersen.plot(test4) # must have strata, plots the cumilated hazard function for the levels of the strata variable
# Fitting a Cox model
summary(Cox.fit4)
Cox.fit4 <- coxph(Sur1~ factor(Treatment)+ factor(Sex)+ factor(Ascites)+ strata(Age.groups)+ Prothrombin, data = Cdata)
Age.groups=cut(Cdata$Age,breaks=c(-Inf,quantile(Cdata$Age ,prob=c(0.33,0.66)),Inf)) #devides the Age into 3 groups
Cox.fit4 <- coxph(Sur1~ factor(Treatment)+ factor(Sex)+ factor(Ascites)+ strata(Age.groups)+ Prothrombin, data = Cdata)
# Fitting a Cox model
summary(Cox.fit4)
Age.groups
Age.groups=cut(Cdata$Age,breaks=c(-Inf,quantile(Cdata$Age ,prob=c(0.33,0.66)),Inf)) #devides the Age into 3 groups
Cox.fit4 <- coxph(Sur1~ factor(Treatment)+ factor(Sex)+ factor(Ascites)+ strata(Age.groups)+ Prothrombin, data = Cdata)
# Fitting a Cox model
summary(Cox.fit4)
source("andersen.R")
test4<-survfit(Cox.fit4)
test4
andersen.plot(test4) # must have strata, plots the cumilated hazard function for the levels of the strata variable
hist(res4)
# Looks good
res4<-residuals(Cox.fit4,type="deviance")
hist(res4)
# look good
boxplot(res4~Cdata$Death_Censoring)
# Looking at Protrombin
min(Cdata[,8])# Lowest 12
max(Cdata[,8])# Highest 135
Prothrombin.groups=cut(Cdata$Prothrombin,breaks=c(-Inf,quantile(Cdata$Prothrombin ,prob=c(0.33,0.66)),Inf)) #devides the Age into 3 groups
Cox.fit5 <- coxph(Sur1~ factor(Treatment)+ factor(Sex)+ factor(Ascites)+ Age+ strata(Prothrombin.groups), data = Cdata)
# Fitting a Cox model
summary(Cox.fit5)
test5<-survfit(Cox.fit5)
test5
andersen.plot(test5) # must have strata, plots the cumilated hazard function for the levels of the strata variable
andersen.plot(test4) # must have strata, plots the cumilated hazard function for the levels of the strata variable
#looks good
res5<-residuals(Cox.fit5,type="deviance")
hist(res5)
hist(res4)
boxplot(res5~Cdata$Death_Censoring)
new.surf<-survfit(Cox.fit,newdata = data.frame(Treatment=0,Sex=1,Age=57,Ascites=1,Prothrombin=85))
autoplot(new.surf,xlab="Days",ylab="Overall survival probability")+
geom_vline(xintercept = new.age)
Sur1 <- Surv(Cdata$Time, Cdata$Death_Censoring)
Cox.fit <- coxph(Sur1~ factor(Treatment)+ factor(Sex)+ factor(Ascites)+ Age+ Prothrombin, data = Cdata)
Cox.fit
summary(Cox.fit)
new.age=(65-57)*365
new.surf<-survfit(Cox.fit,newdata = data.frame(Treatment=0,Sex=1,Age=57,Ascites=1,Prothrombin=85))
autoplot(new.surf,xlab="Days",ylab="Overall survival probability")+
geom_vline(xintercept = new.age)
#plot(sur.fit1,xlab="Days",ylab="Overall survival probability") #a normal plot
autoplot(sur.fit1,xlab="Days",ylab="Overall survival probability") # a clear plot
Cox.fit <- coxph(Sur1~ factor(Treatment)+ factor(Sex)+ factor(Ascites)+ Age+ Prothrombin, data = Cdata)
Cox.fit
summary(Cox.fit)
Cox.fit <- coxph(Sur1~ strata(Treatment)+ factor(Sex)+ factor(Ascites)+ Age+ Prothrombin, data = Cdata)
Cox.fit
summary(Cox.fit)
Cox.fit <- coxph(Sur1~ factor(Treatment)+ factor(Sex)+ factor(Ascites)+ Age+ Prothrombin, data = Cdata)
Cox.fit
summary(Cox.fit)
Cox.fit <- coxph(Sur1~ factor(Treatment==1)+ factor(Sex)+ factor(Ascites)+ Age+ Prothrombin, data = Cdata)
Cox.fit
Cox.fit <- coxph(Sur1~ factor(Treatment==0)+ factor(Sex)+ factor(Ascites)+ Age+ Prothrombin, data = Cdata)
Cox.fit
summary(Cox.fit)
Cox.fit <- coxph(Sur1~ factor(Treatment)+ factor(Sex)+ factor(Ascites)+ Age+ Prothrombin, data = Cdata)
Cox.fit
summary(Cox.fit)
Cox.fit <- coxph(Sur1~ factor(Treatment)+ factor(Sex)+ factor(Ascites)+ Age+ Prothrombin, data = Cdata)
Cox.fit_T0 <- coxph(Sur1~ factor(Treatment==0)+ factor(Sex)+ factor(Ascites)+ Age+ Prothrombin, data = Cdata)
Cox.fit_T1 <- coxph(Sur1~ factor(Treatment==1)+ factor(Sex)+ factor(Ascites)+ Age+ Prothrombin, data = Cdata)
summary(Cox.fit)
summary(Cox.fit_T0)
summary(Cox.fit_T1)
summary(Cox.fit)
summary(Cox.fit_T0)
summary(Cox.fit_T1)
summary(Cox.fit)
summary(Cox.fit_T0)
Cox.fit <- coxph(Sur1~ factor(Treatment)+ factor(Sex)+ factor(Ascites)+ Age+ Prothrombin, data = Cdata)
summary(Cox.fit)
# pull out different variables to see the effect, leveled varables are not of intresed since all information have be extracted.
# Looking at the model without Age
Sur1 <- Surv(Cdata$Time, Cdata$Death_Censoring)
Cox.fit._age <- coxph(Sur1~ factor(Treatment)+ factor(Sex)+ factor(Ascites)+ Prothrombin, data = Cdata)
res_age=residuals(Cox.fit._age)
scatter.smooth(Cdata$Age, res_age)
#Looking at the model without Prothrombin
Sur1 <- Surv(Cdata$Time, Cdata$Death_Censoring)
Cox.fit._Prothrombin <- coxph(Sur1~ factor(Treatment)+ factor(Sex)+ factor(Ascites)+ Age, data = Cdata)
res_Prothrombin=residuals(Cox.fit._Prothrombin)
scatter.smooth(Cdata$Prothrombin, res_Prothrombin)
scatter.smooth(Cdata$Age, res_age)
scatter.smooth(Cdata$Prothrombin, res_Prothrombin)
Sur1 <- Surv(Cdata$Time, Cdata$Death_Censoring) #our survival function
#Interaction Treatment and Sex
Cox.fit_TS <- coxph(Sur1~ factor(Treatment)*factor(Sex)+ factor(Ascites)+ Age+ Prothrombin, data = Cdata)
Cox.fit_TS
summary(Cox.fit_TS)
#Interaction Treatment and Ascites
Cox.fit_TA <- coxph(Sur1~ factor(Sex)+factor(Treatment)*factor(Ascites)+ Age+ Prothrombin, data = Cdata)
Cox.fit_TA
summary(Cox.fit_TA)
#standard model
Cox.fit <- coxph(Sur1~ factor(Treatment)+ factor(Sex)+ factor(Ascites)+ Age+ Prothrombin, data = Cdata)
Cox.fit
summary(Cox.fit)
# note here that Ascites contains 3 variables, so the p-values can't be interpreted directly so we compair Likelihood ratio tests against the standard model
#we use a anova co get the chi squared value for the 2 models, the difference in likelihood ratio test is 139.1-129.5=9.4 and the DF is 8-6=2
anova(Cox.fit_TA,Cox.fit) # we get at p-value of 0.008 so it is significant.
# Because we have 3 levels in Ascites we get 2 varaibles in our model, each has a significans accounting to the p-value, however it is adviced to look at the model as a whole and compaire it to the orginal model.
#standard model
Cox.fit <- coxph(Sur1~ factor(Treatment)+ factor(Sex)+ factor(Ascites)+ Age+ Prothrombin, data = Cdata)
Cox.fit
summary(Cox.fit)
#Interaction Treatment and Age
Cox.fit_TAA <- coxph(Sur1~ factor(Sex)+factor(Ascites)+ factor(Treatment)*Age+ Prothrombin, data = Cdata)
Cox.fit_TAA
summary(Cox.fit_TAA)
#Interaction Treatment and Prothrombin
Cox.fit_TP <- coxph(Sur1~ factor(Sex)+factor(Ascites)+ Age+factor(Treatment)*Prothrombin, data = Cdata)
Cox.fit_TP
summary(Cox.fit_TP)
summary(Cox.fit_TAA)
summary(Cox.fit_TP)
summary(Cox.fit_TA)
summary(Cox.fit_TP)
autoplot(new.surf,xlab="Days",ylab="Overall survival probability")+
geom_vline(xintercept = new.age)
>>>>>>> e0cec29a27aa2413ceee235b9faad81b4735fba4
